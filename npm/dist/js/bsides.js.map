{"version":3,"file":"bsides.js","sources":["../../js/input-store.js","../../js/input.js","../../js/button.js","../../js/bsides.js"],"sourcesContent":["const inputStore = new Map()\n\nexport default {\n  set(element, key, instance) {\n    if (!inputStore.has(element)) {\n      inputStore.set(element, new Map())\n    }\n\n    const instanceStore = inputStore.get(element)\n\n    if (!instanceStore.has(key) && instanceStore.size !== 0) {\n      return\n    }\n\n    instanceStore.set(key, instance)\n  },\n  get(element, key) {\n    if (inputStore.has(element)) {\n      return inputStore.get(element).get(key) || null\n    }\n\n    return null\n  },\n  remove(element, key) {\n    if (!inputStore.has(element)) {\n      return\n    }\n\n    const store = inputStore.get(element)\n\n    store.delete(key)\n\n    if (store.size === 0) {\n      inputStore.delete(element)\n    }\n  }\n}","import $ from 'jquery'\n\nimport InputStore from './input-store.js'\n\nclass Input {\n  // getters\n\n  static get BINDING_KEY() {\n    return `bsides.${this.NAME}`\n  }\n\n  static get EVENT_KEY() {\n    return `.${this.BINDING_KEY}`\n  }\n\n  static get EVENTS() {\n    return null\n  }\n\n  static get SELECTOR() {\n    return `.bsides-${this.NAME}`\n  }\n\n  // public\n\n  constructor(element) {\n    this._element = element\n    this._value = null\n    this._debounce = false\n    this._callback = (debounce) => {}\n\n    InputStore.set(element, this.constructor.BINDING_KEY, this)\n  }\n\n  value(x) {\n    return null\n  }\n\n  content(x) {\n    return null\n  }\n\n  dispose() {\n    this._callback = () => {}\n    InputStore.remove(element, this.constructor.BINDING_KEY)\n  }\n\n  // static\n\n  static find(scope) {\n    return $(scope).find(this.SELECTOR)\n  }\n\n  static getId(element) {\n    return element.id\n  }\n\n  static getType(element) {\n    return null\n    element // unused\n  }\n\n  static getValue(element) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      return null\n    }\n\n    return input.value()\n  }\n\n  static subscribe(element, callback) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      return\n    }\n\n    input._callback = callback\n  }\n\n  static unsubscribe(element) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      return\n    }\n\n    input.dispose()\n  }\n\n  static receiveMessage(element, data) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      return\n    }\n\n    for (const [method, args] of Object.entries(data)) {\n      input[method](args)\n    }\n  }\n\n  static getState(element) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      return\n    }\n\n    return { value: input.value() }\n  }\n\n  // @return { policy: RatePolicyModes, delay: number }\n  static getRatePolicy(element) {\n    return null\n    element // unused\n  }\n\n  static initialize(element) {\n    element // unused\n  }\n\n  static dispose(element) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      return\n    }\n\n    input.dispose()\n  }\n\n  static ShinyInterface() {\n    return this\n  }\n}\n\nexport default Input\n","import $ from 'jquery'\n\nimport InputStore from './input-store.js'\nimport Input from './input.js'\n\nclass ButtonInput extends Input {\n  static get NAME() {\n    return 'button'\n  }\n\n  static get EVENTS() {\n    return `click${this.EVENT_KEY}`\n  }\n\n  constructor(element) {\n    super(element)\n\n    this._value = 0\n  }\n\n  value(x) {\n    if (typeof x === 'undefined') {\n      return this._value\n    }\n\n    this._value = x\n    this._callback(this._debounce)\n\n    return this\n  }\n\n  content(x) {\n    this._element.innerHTML = x\n\n    return this\n  }\n\n  // this argument name is garbo\n  disable(x) {\n    if (x === true) {\n      this._element.setAttribute('disabled', '')\n    } else {\n      this._element.removeAttribute('disabled')\n    }\n\n    return this\n  }\n\n  static initialize(element) {\n    let input = InputStore.get(element, this.BINDING_KEY)\n\n    if (!input) {\n      input = new ButtonInput(element)\n    }\n  }\n}\n\n$(document).on(ButtonInput.EVENTS, ButtonInput.SELECTOR, (event) => {\n  let button = InputStore.get(event.currentTarget, ButtonInput.BINDING_KEY)\n\n  if (!button) {\n    return\n  }\n\n  button.value(button.value() + 1)\n})\n\nif (Shiny) {\n  Shiny.inputBindings.register(ButtonInput.ShinyInterface())\n}\n\nexport default ButtonInput\n","import ButtonInput from './button.js'\n\nexport default {\n  ButtonInput\n}\n"],"names":["inputStore","Map","set","element","key","instance","has","instanceStore","get","size","remove","store","delete","Input","BINDING_KEY","NAME","EVENT_KEY","EVENTS","SELECTOR","constructor","_element","_value","_debounce","_callback","debounce","InputStore","value","x","content","dispose","find","scope","$","getId","id","getType","getValue","input","subscribe","callback","unsubscribe","receiveMessage","data","method","args","Object","entries","getState","getRatePolicy","initialize","ShinyInterface","ButtonInput","innerHTML","disable","setAttribute","removeAttribute","document","on","event","button","currentTarget","Shiny","inputBindings","register"],"mappings":"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"}